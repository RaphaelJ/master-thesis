# Implementation details

The first section summarizes the specifics of the used 36-cores *TileGx*
architecture.

These second section 

## TileGx processor summary

The *TileGx* processor family has been developed by *Tilera*, until the company
was acquired by *EzChip* during the summer 2014.

The family has been declined in 9, 16, 36 and 72-cores models. These use a
proprietary 64 bits RISC instruction set and run at a *1.2 Ghz frequency*.

Each core has a *32 KB L1 instruction cache*, a *32 KB L1 data cache* and a
*256 KB unified L2 cache*. There is no common L3 cache but L2 *caches can be
shared between cores* with an added latency. Details about the memory hierarchy
is given in the *Memory hierarchy* section to follow.

These CPUs are designed to run network related software. Consequently, they
also have:

* *Co-prosessors* for packet analysis, network flow load-balancing, compression
  and encryption.
* *Integrated 10 Gbps Ethernet chipsets* to maximise efficiency, especially on
  small packets.

The device used in to implement and carry out the execution of the TCP stack is
engineered around a 36-core *TileGx* chip, in the form of a PCI-Express
extension card. The device is a computer on its own, having its dedicated DDR3
memory and *four 10 Gbps Ethernet links*.

## Parallelisation and scalability


![Stack architecture](img/architecture.png)

## Memory hierarchy

As said in the *TileGx processor summary* section, the *TileGx* 
micro-architecture does not have a shared L3 cache. Instead, core-local L2
caches can be accessed from other cores, with an increased latency. The
following table summarizes memory subsystems and their main properties 
*[Tile12]*.

| Memory          | Size               | Associativity | Latency (CPU cycles) |
| --------------- | ------------------ | ------------- | -------------------- |
| L1 instruction  | 32 KB              | 2 way         | 2                    |
| L1 data         | 32 KB              | 2 way         | 2                    |
| Local L2        | 256 KB             | 8 way         | 11                   |
| Shared L2       | 36 x 256 KB = 9 MB | 8 way         | 32 to 41             |
| RAM (DDR3-1600) | 16 GB      | Irrelevant    | 67 if page in TLB, 88 if not |

The TileGx architecture allows software developers to choose where memory pages
are cached in the L2 cache. Pages can be either cached in a specific core
(*homed pages*), or spread over the various cores (*hash-homed pages*).

In an ideal world, data shared among several cores should be *hash-homed* while
memory accessed by a single core should be *homed*.

## Abstracting the network stack

## No-copy interface


## Checksum

### Pre-computed checksums

## Micro optimisations



## Performance analysis and cost centres


